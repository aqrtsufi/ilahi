import{d as ce,N as de,r as x,c as m,w,o as ve,x as ge,e as o,f,g as a,p as he,q as $,s as L,t as i,m as d,G as Q,F as y,i as _,n as W,A as j,O as M,P as pe,C as me,u as fe,Q as ye,S as be,k as l}from"./vue-BEpEtYa0.js";import{u as xe,g as _e,p as ke,n as O,t as S,f as Se,C as H,s as Ce}from"./main-zBpTFEO-.js";const we={key:0,class:"space-y-2"},Ae={class:"w-full max-w-4xl mx-auto p-4"},Pe={key:0,class:"mt-4 text-center"},qe={class:"flex flex-wrap justify-center my-4",role:"group","aria-label":"Filter ilahis by first letter"},Be=["onClick","onKeydown","aria-pressed","aria-label"],Le={class:"flex justify-center my-4"},je={class:"flex flex-col items-center"},Me={class:"flex gap-2 mb-2"},Oe=["onClick"],Ne={class:"flex items-center mb-2"},ze=["value"],Re={class:"dropdown"},Ve={key:0,tabindex:"0",class:"dropdown-content z-[1] menu p-2 shadow rounded-box w-52 max-h-60 overflow-y-auto custom-dropdown"},De={key:0,class:"dropdown"},Ee={class:"text-base-content"},Fe={class:"p-2 shadow menu dropdown-content z-[1] bg-base-100 rounded-box w-52"},Ie={class:"text-base-content"},Te=["value"],Ue={key:1,class:"text-base-content"},Ze=["value"],Ge={class:"flex justify-center my-4"},Ke={class:"flex flex-col items-center"},$e={class:"dropdown dropdown-end"},Qe={tabindex:"0",class:"dropdown-content z-[1] menu p-2 shadow bg-base-100 rounded-box w-64 max-h-96 overflow-y-auto"},We={class:"dropdown",open:""},He={class:"text-base-content font-semibold"},Je={class:"p-2"},Ye={class:"flex items-center gap-2 p-2 hover:bg-base-200 rounded"},Xe=["value"],et={class:"text-base-content"},tt={class:"text-center text-base-content/80 mb-4",role:"status","aria-live":"polite"},st={key:0,"aria-atomic":"true"},at={key:1,"aria-atomic":"true"},lt={key:2,"aria-atomic":"true"},ot={key:3,"aria-atomic":"true"},nt={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},rt={key:2,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},it={class:"text-xl font-semibold mb-2"},ut={key:1,class:"text-gray-500"},ct={key:3,class:"text-center text-xl text-gray-600",role:"alert","aria-live":"assertive"},dt={key:4},vt={key:5,class:"mt-6 flex justify-center"},gt=["disabled"],ht={class:"mx-2 self-center"},pt=["disabled"],E=12,yt=ce({__name:"SongList",props:{filePath:{}},setup(J){var U;const F=J,b=ge(),N=fe(),g=xe(),{filteredSongs:k,categories:C,filteredByZikr:A,selectedZikrs:p}=de(g),I=x(!0),c=x(1),r=x(""),n=x([]);x(!1);const Y=m(()=>Object.entries(g.suggestedZikrs).map(([t,e])=>({group:t,items:Array.isArray(e)?e:[e]}))),P=x(null),X=(t,e)=>{(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),T(e))},ee=()=>{if(v.value.length>0){const t=Math.floor(Math.random()*v.value.length);P.value=v.value[t]}},te=ye("resetGlobalSearch"),se=m(()=>{const t={};for(const e in q.value){const s=q.value[e];Array.isArray(s)&&(t[e]=[...s].sort((u,h)=>u.localeCompare(h)))}return t}),q=m(()=>_e());m(()=>{const{processedCategories:t}=ke(q.value),e={},s=new Set(Object.values(t).flat().map(O));return k.value.forEach(u=>{u.categories.forEach(h=>{const V=O(h),Z=Object.keys(C.value||{}).find(G=>{var K;const D=(K=C.value)==null?void 0:K[G];return!D||!Array.isArray(D)?!1:O(G)===V||D.some(ue=>O(ue).startsWith(V))});Z?e[Z]=!0:h.trim()!==""&&!s.has(V)&&(e[h.trim()]=!0)})}),Object.keys(e)});const ae=m(()=>Array.isArray(C.value)?C.value:Object.keys(C.value||{})),v=m(()=>{let t=k.value;return p.value.length>0&&(console.log("[Component] Applying zikr filter"),t=A.value),r.value&&(t=t.filter(e=>{const s=e.title[0].toUpperCase(),u=S(s),h=S(r.value);return u===h})),n.value.length>0&&!n.value.includes("All")&&(t=Se(t,n.value)),n.value.length===1&&n.value[0]===H.BASIC?t:t.sort((e,s)=>S(e.title.toLowerCase()).localeCompare(S(s.title.toLowerCase())))}),z=m(()=>Math.ceil(v.value.length/E));m(()=>v.value.map(t=>({...t,slug:Ce(t.title)})));const B=m(()=>{const t=(c.value-1)*E,e=t+E;return v.value.slice(t,e)}),le=()=>{c.value>1&&c.value--},oe=()=>{c.value<z.value&&c.value++},T=t=>{const e=t.toUpperCase();r.value=r.value===e?"":e;const s={};r.value&&(s.letter=r.value),n.value.length>0&&(s.categories=n.value),c.value=1,N.push({query:s})},ne=()=>{const t={};r.value&&(t.letter=r.value),n.value.length>0&&(t.categories=n.value),N.push({query:t}).catch(()=>{console.log("Navigation prevented")})};m(()=>({filtered:v.value.length,paginated:B.value.length,total:k.value.length})),w(p,t=>{console.log("[Component] Selected Zikrs changed:",t),console.log("Current filtered songs:",A.value.map(e=>e.title))},{deep:!0}),w(r,t=>{c.value=1},{immediate:!0}),w([k,r,p,n],()=>{c.value=1,ne()}),w(()=>b.query,t=>{if(t.search)g.setSearchQuery(String(t.search)),c.value=1,r.value="",n.value=[];else if(t.letter)r.value=String(t.letter),c.value=1,g.setSearchQuery("");else if(t.categories){const e=Array.isArray(t.categories)?t.categories.map(String):[String(t.categories)];n.value=e.filter(Boolean),c.value=1,g.setSearchQuery("")}else g.setSearchQuery(""),r.value="",n.value=[],c.value=1},{immediate:!0}),w(()=>F.filePath,async(t,e)=>{t&&t!==e&&await g.fetchSongs(!1,t)},{immediate:!0}),ve(async()=>{try{if(await g.fetchSongs(!1,F.filePath||"ilahi.txt"),b.query.search&&g.setSearchQuery(String(b.query.search)),b.query.categories){const t=Array.isArray(b.query.categories)?b.query.categories.map(String):[String(b.query.categories)];n.value=t.filter(Boolean)}}finally{I.value=!1}});const re=()=>{g.setSearchQuery(""),r.value="",n.value=[],p.value=[],N.push({query:{}}),te()},R=x(!1);(U=be())==null||U.appContext.app;function ie(t){const e=n.value.indexOf(t);e===-1?n.value.push(t):n.value.splice(e,1)}return(t,e)=>(l(),o(y,null,[I.value?(l(),o("div",we,e[5]||(e[5]=[a("div",{class:"skeleton h-6 w-1/2"},null,-1),a("div",{class:"skeleton h-6 w-2/3"},null,-1),a("div",{class:"skeleton h-6 w-1/3"},null,-1)]))):f("",!0),a("div",Ae,[a("button",{onClick:re,class:"btn btn-secondary"},"Reset Search"),a("button",{onClick:ee,class:"btn btn-primary"},"What to Sing?"),P.value?(l(),o("div",Pe,[e[6]||(e[6]=a("p",null,"Try to Sing:",-1)),he(d(Q),{to:{name:"SongDisplay",params:{slug:P.value.slug},query:{file:d(g).currentPath}},class:"text-primary hover:underline"},{default:$(()=>[L(i(P.value.title),1)]),_:1},8,["to"])])):f("",!0),a("div",qe,[(l(),o(y,null,_("ABCÇDEFGĞHIİJKLMNOÖPQRSŞTUÜVYZ",s=>a("button",{key:s,onClick:u=>T(s),onKeydown:u=>X(u,s),class:W(["btn btn-sm m-1",{"btn-primary":r.value===s||r.value&&d(S)(r.value)===d(S)(s)}]),"aria-pressed":r.value===s,"aria-label":`Filter by letter ${s}`,tabindex:"0"},i(s),43,Be)),64))]),a("div",Le,[a("div",je,[e[8]||(e[8]=a("label",{class:"mb-2 font-bold text-lg"},"Categories",-1)),a("div",Me,[(l(),o(y,null,_(["Shaykh Muhyiddin","Shaykh Taner and Shaykha Muzeyyen"],s=>a("span",{key:s,onClick:u=>ie(s),class:W(["px-2 py-0.5 rounded-full cursor-pointer border text-xs font-semibold transition-colors border-green-200",[n.value.includes(s)?"bg-green-600 text-white border-green-600":"bg-green-100 text-green-800 hover:bg-green-200"]])},i(s),11,Oe)),64))]),a("div",Ne,[j(a("input",{type:"checkbox",id:"basicCategory","onUpdate:modelValue":e[0]||(e[0]=s=>n.value=s),value:d(H).BASIC,class:"checkbox checkbox-primary mr-2 custom-checkbox"},null,8,ze),[[M,n.value]]),e[7]||(e[7]=a("label",{for:"basicCategory",class:"text-lg font-semibold text-primary"},"Basic ilahis For Zikr",-1))]),a("div",Re,[a("label",{tabindex:"0",class:"btn btn-secondary m-1",onClick:e[1]||(e[1]=s=>R.value=!R.value)},"More Categories"),R.value?(l(),o("ul",Ve,[(l(!0),o(y,null,_(ae.value,s=>(l(),o("li",{key:String(s),class:"text-left"},[Object.keys(q.value).includes(String(s))?(l(),o("details",De,[a("summary",Ee,i(s),1),a("ul",Fe,[(l(!0),o(y,null,_(se.value[String(s)],u=>(l(),o("li",{key:String(u),class:"text-left"},[a("label",Ie,[j(a("input",{type:"checkbox",value:u,"onUpdate:modelValue":e[2]||(e[2]=h=>n.value=h),class:"checkbox custom-checkbox"},null,8,Te),[[M,n.value]]),L(" "+i(u),1)])]))),128))])])):(l(),o("label",Ue,[j(a("input",{type:"checkbox",value:s,"onUpdate:modelValue":e[3]||(e[3]=u=>n.value=u),class:"checkbox custom-checkbox"},null,8,Ze),[[M,n.value]]),L(" "+i(s),1)]))]))),128))])):f("",!0)])])]),a("div",Ge,[a("div",Ke,[a("div",$e,[e[9]||(e[9]=a("label",{tabindex:"0",class:"btn btn-secondary m-1"}," Select Zikr ",-1)),a("ul",Qe,[(l(!0),o(y,null,_(Y.value,s=>(l(),o("li",{key:s.group},[a("details",We,[a("summary",He,i(s.group),1),a("ul",Je,[(l(!0),o(y,null,_(s.items,u=>(l(),o("li",{key:u},[a("label",Ye,[j(a("input",{type:"checkbox",value:u,"onUpdate:modelValue":e[4]||(e[4]=h=>pe(p)?p.value=h:null),class:"checkbox checkbox-primary"},null,8,Xe),[[M,d(p)]]),a("span",et,i(u),1)])]))),128))])])]))),128))])])])]),a("div",tt,[d(p).length>0?(l(),o("span",st,i(d(A).length)+" ilahi"+i(d(A).length!==1?"s":"")+" found for: "+i(d(p).join(", ")),1)):r.value?(l(),o("span",at,i(v.value.length)+" ilahi"+i(v.value.length!==1?"s":"")+' found starting with letter "'+i(r.value)+'" ',1)):n.value.length>0?(l(),o("span",lt,i(v.value.length)+" ilahi"+i(v.value.length!==1?"s":"")+" found in selected categories ",1)):(l(),o("span",ot,i(d(k).length)+" ilahi"+i(d(k).length!==1?"s":"")+" available ",1))]),v.value.length>0?(l(),o("div",nt)):f("",!0),B.value.length?(l(),o("div",rt,[(l(!0),o(y,null,_(B.value,(s,u)=>(l(),o("div",{key:s.slug,class:"shadow-md rounded-lg p-4"},[a("h3",it,[s.title?(l(),me(d(Q),{key:0,to:{name:"SongDisplay",params:{slug:s.slug},query:{file:d(g).currentPath}},class:"hover:link-secondary"},{default:$(()=>[L(i(s.title),1)]),_:2},1032,["to"])):(l(),o("span",ut,"All"))]),e[10]||(e[10]=a("div",{class:"text-sm text-gray-600"},null,-1))]))),128))])):f("",!0),v.value.length===0&&r.value?(l(),o("div",ct,' Sorry, no ilahi found starting with letter "'+i(r.value)+'". ',1)):f("",!0),B.value.length===0&&d(p).length?(l(),o("div",dt,e[11]||(e[11]=[a("p",{class:"text-red-500"},"No songs found for selected zikrs",-1)]))):f("",!0),v.value.length>0?(l(),o("div",vt,[a("button",{onClick:le,disabled:c.value===1,class:"btn btn-primary mr-2"}," < Previous ",8,gt),a("span",ht,"Page "+i(c.value)+" of "+i(z.value),1),a("button",{onClick:oe,disabled:c.value===z.value,class:"btn btn-primary ml-2"}," Next > ",8,pt)])):f("",!0)])],64))}});export{yt as _};
