import{d as ue,M as ce,r as k,c as m,w,o as de,x as ve,e as o,g as a,f as b,p as ge,m as d,E as $,q as G,s as L,t as i,F as y,i as x,n as Q,z as j,N as M,O as he,B as pe,u as me,P as fe,Q as be,k as l}from"./vue-Car_zgcF.js";import{u as ye,g as xe,p as _e,n as O,t as S,f as ke,C as W,s as Se}from"./main-DiVm8OM4.js";const Ce={class:"w-full max-w-4xl mx-auto p-4"},we={key:0,class:"mt-4 text-center"},Ae={class:"flex flex-wrap justify-center my-4",role:"group","aria-label":"Filter ilahis by first letter"},Be=["onClick","onKeydown","aria-pressed","aria-label"],Pe={class:"flex justify-center my-4"},qe={class:"flex flex-col items-center"},Le={class:"flex gap-2 mb-2"},je=["onClick"],Me={class:"flex items-center mb-2"},Oe=["value"],Ne={class:"dropdown"},ze={key:0,tabindex:"0",class:"dropdown-content z-[1] menu p-2 shadow rounded-box w-52 max-h-60 overflow-y-auto custom-dropdown"},Ee={key:0,class:"dropdown"},Re={class:"text-base-content"},Ve={class:"p-2 shadow menu dropdown-content z-[1] bg-base-100 rounded-box w-52"},De={class:"text-base-content"},Fe=["value"],Ie={key:1,class:"text-base-content"},Te=["value"],Ue={class:"flex justify-center my-4"},Ze={class:"flex flex-col items-center"},Ke={class:"dropdown dropdown-end"},$e={tabindex:"0",class:"dropdown-content z-[1] menu p-2 shadow bg-base-100 rounded-box w-64 max-h-96 overflow-y-auto"},Ge={class:"dropdown",open:""},Qe={class:"text-base-content font-semibold"},We={class:"p-2"},He={class:"flex items-center gap-2 p-2 hover:bg-base-200 rounded"},Je=["value"],Ye={class:"text-base-content"},Xe={class:"text-center text-base-content/80 mb-4",role:"status","aria-live":"polite"},et={key:0,"aria-atomic":"true"},tt={key:1,"aria-atomic":"true"},st={key:2,"aria-atomic":"true"},at={key:3,"aria-atomic":"true"},lt={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},ot={key:2,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},rt={class:"text-xl font-semibold mb-2"},nt={key:1,class:"text-gray-500"},it={key:3,class:"text-center text-xl text-gray-600",role:"alert","aria-live":"assertive"},ut={key:4},ct={key:5,class:"mt-6 flex justify-center"},dt=["disabled"],vt={class:"mx-2 self-center"},gt=["disabled"],D=12,mt=ue({__name:"SongList",props:{filePath:{}},setup(H){var T;const F=H,f=ve(),N=me(),g=ye(),{filteredSongs:_,categories:C,filteredByZikr:A,selectedZikrs:p}=ce(g),c=k(1),n=k(""),r=k([]);k(!1);const J=m(()=>Object.entries(g.suggestedZikrs).map(([e,t])=>({group:e,items:Array.isArray(t)?t:[t]}))),B=k(null),Y=(e,t)=>{(e.key==="Enter"||e.key===" ")&&(e.preventDefault(),I(t))},X=()=>{if(v.value.length>0){const e=Math.floor(Math.random()*v.value.length);B.value=v.value[e]}},ee=fe("resetGlobalSearch"),te=m(()=>{const e={};for(const t in P.value){const s=P.value[t];Array.isArray(s)&&(e[t]=[...s].sort((u,h)=>u.localeCompare(h)))}return e}),P=m(()=>xe());m(()=>{const{processedCategories:e}=_e(P.value),t={},s=new Set(Object.values(e).flat().map(O));return _.value.forEach(u=>{u.categories.forEach(h=>{const R=O(h),U=Object.keys(C.value||{}).find(Z=>{var K;const V=(K=C.value)==null?void 0:K[Z];return!V||!Array.isArray(V)?!1:O(Z)===R||V.some(ie=>O(ie).startsWith(R))});U?t[U]=!0:h.trim()!==""&&!s.has(R)&&(t[h.trim()]=!0)})}),Object.keys(t)});const se=m(()=>Array.isArray(C.value)?C.value:Object.keys(C.value||{})),v=m(()=>{let e=_.value;return p.value.length>0&&(console.log("[Component] Applying zikr filter"),e=A.value),n.value&&(e=e.filter(t=>{const s=t.title[0].toUpperCase(),u=S(s),h=S(n.value);return u===h})),r.value.length>0&&!r.value.includes("All")&&(e=ke(e,r.value)),r.value.length===1&&r.value[0]===W.BASIC?e:e.sort((t,s)=>S(t.title.toLowerCase()).localeCompare(S(s.title.toLowerCase())))}),z=m(()=>Math.ceil(v.value.length/D));m(()=>v.value.map(e=>({...e,slug:Se(e.title)})));const q=m(()=>{const e=(c.value-1)*D,t=e+D;return v.value.slice(e,t)}),ae=()=>{c.value>1&&c.value--},le=()=>{c.value<z.value&&c.value++},I=e=>{const t=e.toUpperCase();n.value=n.value===t?"":t;const s={};n.value&&(s.letter=n.value),r.value.length>0&&(s.categories=r.value),c.value=1,N.push({query:s})},oe=()=>{const e={};n.value&&(e.letter=n.value),r.value.length>0&&(e.categories=r.value),N.push({query:e}).catch(()=>{console.log("Navigation prevented")})};m(()=>({filtered:v.value.length,paginated:q.value.length,total:_.value.length})),w(p,e=>{console.log("[Component] Selected Zikrs changed:",e),console.log("Current filtered songs:",A.value.map(t=>t.title))},{deep:!0}),w(n,e=>{c.value=1},{immediate:!0}),w([_,n,p,r],()=>{c.value=1,oe()}),w(()=>f.query,e=>{if(e.search)g.setSearchQuery(String(e.search)),c.value=1,n.value="",r.value=[];else if(e.letter)n.value=String(e.letter),c.value=1,g.setSearchQuery("");else if(e.categories){const t=Array.isArray(e.categories)?e.categories.map(String):[String(e.categories)];r.value=t.filter(Boolean),c.value=1,g.setSearchQuery("")}else g.setSearchQuery(""),n.value="",r.value=[],c.value=1},{immediate:!0}),w(()=>F.filePath,async(e,t)=>{e&&e!==t&&await g.fetchSongs(!1,e)},{immediate:!0}),de(async()=>{if(await g.fetchSongs(!1,F.filePath||"ilahi.txt"),f.query.search&&g.setSearchQuery(String(f.query.search)),f.query.categories){const e=Array.isArray(f.query.categories)?f.query.categories.map(String):[String(f.query.categories)];r.value=e.filter(Boolean)}});const re=()=>{g.setSearchQuery(""),n.value="",r.value=[],p.value=[],N.push({query:{}}),ee()},E=k(!1);(T=be())==null||T.appContext.app;function ne(e){const t=r.value.indexOf(e);t===-1?r.value.push(e):r.value.splice(t,1)}return(e,t)=>(l(),o("div",Ce,[a("button",{onClick:re,class:"btn btn-secondary"},"Reset Search"),a("button",{onClick:X,class:"btn btn-primary"},"What to Sing?"),B.value?(l(),o("div",we,[t[5]||(t[5]=a("p",null,"Try to Sing:",-1)),ge(d($),{to:{name:"SongDisplay",params:{slug:B.value.slug},query:{file:d(g).currentPath}},class:"text-primary hover:underline"},{default:G(()=>[L(i(B.value.title),1)]),_:1},8,["to"])])):b("",!0),a("div",Ae,[(l(),o(y,null,x("ABCÇDEFGĞHIİJKLMNOÖPQRSŞTUÜVYZ",s=>a("button",{key:s,onClick:u=>I(s),onKeydown:u=>Y(u,s),class:Q(["btn btn-sm m-1",{"btn-primary":n.value===s||n.value&&d(S)(n.value)===d(S)(s)}]),"aria-pressed":n.value===s,"aria-label":`Filter by letter ${s}`,tabindex:"0"},i(s),43,Be)),64))]),a("div",Pe,[a("div",qe,[t[7]||(t[7]=a("label",{class:"mb-2 font-bold text-lg"},"Categories",-1)),a("div",Le,[(l(),o(y,null,x(["Shaykh Taner","Shaykh Muhyiddin"],s=>a("span",{key:s,onClick:u=>ne(s),class:Q(["px-2 py-0.5 rounded-full cursor-pointer border text-xs font-semibold transition-colors border-green-200",[r.value.includes(s)?"bg-green-600 text-white border-green-600":"bg-green-100 text-green-800 hover:bg-green-200"]])},i(s),11,je)),64))]),a("div",Me,[j(a("input",{type:"checkbox",id:"basicCategory","onUpdate:modelValue":t[0]||(t[0]=s=>r.value=s),value:d(W).BASIC,class:"checkbox checkbox-primary mr-2 custom-checkbox"},null,8,Oe),[[M,r.value]]),t[6]||(t[6]=a("label",{for:"basicCategory",class:"text-lg font-semibold text-primary"},"Basic ilahis For Zikr",-1))]),a("div",Ne,[a("label",{tabindex:"0",class:"btn btn-secondary m-1",onClick:t[1]||(t[1]=s=>E.value=!E.value)},"More Categories"),E.value?(l(),o("ul",ze,[(l(!0),o(y,null,x(se.value,s=>(l(),o("li",{key:String(s),class:"text-left"},[Object.keys(P.value).includes(String(s))?(l(),o("details",Ee,[a("summary",Re,i(s),1),a("ul",Ve,[(l(!0),o(y,null,x(te.value[String(s)],u=>(l(),o("li",{key:String(u),class:"text-left"},[a("label",De,[j(a("input",{type:"checkbox",value:u,"onUpdate:modelValue":t[2]||(t[2]=h=>r.value=h),class:"checkbox custom-checkbox"},null,8,Fe),[[M,r.value]]),L(" "+i(u),1)])]))),128))])])):(l(),o("label",Ie,[j(a("input",{type:"checkbox",value:s,"onUpdate:modelValue":t[3]||(t[3]=u=>r.value=u),class:"checkbox custom-checkbox"},null,8,Te),[[M,r.value]]),L(" "+i(s),1)]))]))),128))])):b("",!0)])])]),a("div",Ue,[a("div",Ze,[a("div",Ke,[t[8]||(t[8]=a("label",{tabindex:"0",class:"btn btn-secondary m-1"}," Select Zikr ",-1)),a("ul",$e,[(l(!0),o(y,null,x(J.value,s=>(l(),o("li",{key:s.group},[a("details",Ge,[a("summary",Qe,i(s.group),1),a("ul",We,[(l(!0),o(y,null,x(s.items,u=>(l(),o("li",{key:u},[a("label",He,[j(a("input",{type:"checkbox",value:u,"onUpdate:modelValue":t[4]||(t[4]=h=>he(p)?p.value=h:null),class:"checkbox checkbox-primary"},null,8,Je),[[M,d(p)]]),a("span",Ye,i(u),1)])]))),128))])])]))),128))])])])]),a("div",Xe,[d(p).length>0?(l(),o("span",et,i(d(A).length)+" ilahi"+i(d(A).length!==1?"s":"")+" found for: "+i(d(p).join(", ")),1)):n.value?(l(),o("span",tt,i(v.value.length)+" ilahi"+i(v.value.length!==1?"s":"")+' found starting with letter "'+i(n.value)+'" ',1)):r.value.length>0?(l(),o("span",st,i(v.value.length)+" ilahi"+i(v.value.length!==1?"s":"")+" found in selected categories ",1)):(l(),o("span",at,i(d(_).length)+" ilahi"+i(d(_).length!==1?"s":"")+" available ",1))]),v.value.length>0?(l(),o("div",lt)):b("",!0),q.value.length?(l(),o("div",ot,[(l(!0),o(y,null,x(q.value,(s,u)=>(l(),o("div",{key:s.slug,class:"shadow-md rounded-lg p-4"},[a("h3",rt,[s.title?(l(),pe(d($),{key:0,to:{name:"SongDisplay",params:{slug:s.slug},query:{file:d(g).currentPath}},class:"text-blue-600 hover:text-blue-800"},{default:G(()=>[L(i(s.title),1)]),_:2},1032,["to"])):(l(),o("span",nt,"All"))]),t[9]||(t[9]=a("div",{class:"text-sm text-gray-600"},null,-1))]))),128))])):b("",!0),v.value.length===0&&n.value?(l(),o("div",it,' Sorry, no ilahi found starting with letter "'+i(n.value)+'". ',1)):b("",!0),q.value.length===0&&d(p).length?(l(),o("div",ut,t[10]||(t[10]=[a("p",{class:"text-red-500"},"No songs found for selected zikrs",-1)]))):b("",!0),v.value.length>0?(l(),o("div",ct,[a("button",{onClick:ae,disabled:c.value===1,class:"btn btn-primary mr-2"}," < Previous ",8,dt),a("span",vt,"Page "+i(c.value)+" of "+i(z.value),1),a("button",{onClick:le,disabled:c.value===z.value,class:"btn btn-primary ml-2"}," Next > ",8,gt)])):b("",!0)]))}});export{mt as _};
